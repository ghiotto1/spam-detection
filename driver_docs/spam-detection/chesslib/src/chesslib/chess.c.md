<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Chess game implementation with functions for game state management, move execution, and draw claims.

# Purpose
The code is a C implementation of a chess game, providing functionality to manage and manipulate the state of a chess game. It includes functions to create and initialize a chess game, either from the standard initial position or from a given FEN (Forsyth-Edwards Notation) string. The code manages the game state through a `chess` structure, which includes the board history, move history, current legal moves, and terminal state. The code also provides functions to play and undo moves, check the game's terminal state, and claim draws based on the 50-move rule or threefold repetition.

The implementation includes functions to retrieve various aspects of the game state, such as the current board, legal moves, and move history. It also provides utility functions to check if a player is in check, if a square is attacked, and to get the FEN representation of the current board. The code uses external libraries or modules, as indicated by the inclusion of `chesslib/chess.h` and `chesslib/move.h`, which likely define the `chess`, `board`, and `move` structures and related operations. The code is designed to be part of a larger chess application, providing core functionality for managing the state and rules of a chess game.
# Imports and Dependencies

---
- `stdlib.h`
- `chesslib/chess.h`
- `chesslib/move.h`


# Functions

---
### chessCreate<!-- {{#callable:chessCreate}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L11>)

Creates a new chess game instance using the initial FEN string.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the [`chessCreateFen`](<#chesscreatefen>) function with the `INITIAL_FEN` constant as an argument.
    - Returns the result of the [`chessCreateFen`](<#chesscreatefen>) function call.
- **Output**: A pointer to a `chess` structure representing a new chess game instance, or `NULL` if initialization fails.
- **Functions Called**:
    - [`chessCreateFen`](<#chesscreatefen>)


---
### chessCreateFen<!-- {{#callable:chessCreateFen}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L16>)

Creates a new chess game instance from a given FEN string.
- **Inputs**:
    - `fen`: A string representing the board position in Forsyth-Edwards Notation (FEN).
- **Logic and Control Flow**:
    - Allocate memory for a new `chess` structure and assign it to pointer `c`.
    - Call [`chessInitFenInPlace`](<#chessinitfeninplace>) with `c` and `fen` to initialize the chess game state.
    - If [`chessInitFenInPlace`](<#chessinitfeninplace>) returns a non-zero value, free the allocated memory for `c` and return `NULL`.
    - If initialization is successful, return the pointer `c`.
- **Output**: A pointer to a `chess` structure initialized with the given FEN string, or `NULL` if initialization fails.
- **Functions Called**:
    - [`chessInitFenInPlace`](<#chessinitfeninplace>)


---
### chessInitInPlace<!-- {{#callable:chessInitInPlace}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L29>)

Initializes a `chess` structure with the initial chess position using the FEN string.
- **Inputs**:
    - `c`: A pointer to a `chess` structure that will be initialized.
- **Logic and Control Flow**:
    - Calls the function [`chessInitFenInPlace`](<#chessinitfeninplace>) with the `chess` pointer `c` and the constant `INITIAL_FEN` to set up the initial chess position.
- **Output**: No return value; the function initializes the `chess` structure in place.
- **Functions Called**:
    - [`chessInitFenInPlace`](<#chessinitfeninplace>)


---
### chessInitFenInPlace<!-- {{#callable:chessInitFenInPlace}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L34>)

Initializes a `chess` structure with a board state from a FEN string and sets up related game state fields.
- **Inputs**:
    - `c`: A pointer to a `chess` structure to initialize.
    - `fen`: A string representing the board state in Forsyth-Edwards Notation (FEN).
- **Logic and Control Flow**:
    - Create a `board` from the FEN string using [`boardCreateFromFen`](<board.c.md#boardcreatefromfen>).
    - If the board creation fails (returns `NULL`), return `1` to indicate failure.
    - Initialize `c->boardHistory` with a new board list and add the created board to it.
    - Initialize `c->moveHistory` with a new move list.
    - Set `c->currentLegalMoves` to `NULL`.
    - Set `c->repetitions` to `1`.
    - Set `c->terminal` to `tsOngoing`.
    - Call [`chessCalculateFields`](<#chesscalculatefields>) to compute repetitions and terminal state.
    - Return `0` to indicate successful initialization.
- **Output**: Returns `0` on successful initialization, or `1` if board creation from FEN fails.
- **Functions Called**:
    - [`boardCreateFromFen`](<board.c.md#boardcreatefromfen>)
    - [`boardListCreate`](<boardlist.c.md#boardlistcreate>)
    - [`boardListAdd`](<boardlist.c.md#boardlistadd>)
    - [`moveListCreate`](<movelist.c.md#movelistcreate>)
    - [`chessCalculateFields`](<#chesscalculatefields>)


---
### chessFree<!-- {{#callable:chessFree}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L55>)

Releases memory allocated for a `chess` structure and its associated lists.
- **Inputs**:
    - `c`: A pointer to a `chess` structure that needs to be freed.
- **Logic and Control Flow**:
    - Call [`boardListFree`](<boardlist.c.md#boardlistfree>) to free the memory of the `boardHistory` list in the `chess` structure.
    - Call [`moveListFree`](<movelist.c.md#movelistfree>) to free the memory of the `moveHistory` list in the `chess` structure.
    - Call [`moveListFree`](<movelist.c.md#movelistfree>) to free the memory of the `currentLegalMoves` list in the `chess` structure.
    - Call `free` to release the memory allocated for the `chess` structure itself.
- **Output**: No return value; the function performs memory deallocation.
- **Functions Called**:
    - [`boardListFree`](<boardlist.c.md#boardlistfree>)
    - [`moveListFree`](<movelist.c.md#movelistfree>)


---
### chessGetBoard<!-- {{#callable:chessGetBoard}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L63>)

Retrieves the current board state from the chess game's board history.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `boardHistory` field of the `chess` structure `c`.
    - Retrieves the `tail` node of the `boardHistory` linked list, which represents the most recent board state.
    - Returns the `board` from the `tail` node.
- **Output**: A pointer to a `board` structure representing the current board state of the chess game.


---
### chessGetLegalMoves<!-- {{#callable:chessGetLegalMoves}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L68>)

Retrieves the list of current legal moves for a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `currentLegalMoves` field of the `chess` structure `c`.
    - Returns the value of `currentLegalMoves`.
- **Output**: A pointer to a `moveList` structure containing the current legal moves in the chess game.


---
### chessGetTerminalState<!-- {{#callable:chessGetTerminalState}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L73>)

Retrieves the terminal state of a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `terminal` field of the `chess` structure pointed to by `c`.
    - Returns the value of the `terminal` field.
- **Output**: The function returns a `terminalState` value, which indicates the current terminal state of the chess game.


---
### chessGetBoardHistory<!-- {{#callable:chessGetBoardHistory}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L78>)

Retrieves the history of board states in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `boardHistory` member of the `chess` structure `c`.
    - Returns the `boardHistory`, which is a list of board states.
- **Output**: A pointer to a `boardList` structure that contains the history of board states.


---
### chessGetMoveHistory<!-- {{#callable:chessGetMoveHistory}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L83>)

Retrieves the move history from a chess game instance.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of a chess game.
- **Logic and Control Flow**:
    - Accesses the `moveHistory` member of the `chess` structure pointed to by `c`.
    - Returns the `moveHistory` which is a list of moves made in the game.
- **Output**: A pointer to a `moveList` structure containing the history of moves made in the chess game.


---
### chessGetRepetitions<!-- {{#callable:chessGetRepetitions}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L88>)

Retrieves the number of times the current board position has been repeated in the game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `repetitions` field of the `chess` structure pointed to by `c`.
    - Returns the value of the `repetitions` field.
- **Output**: Returns an 8-bit unsigned integer representing the number of repetitions of the current board position.


---
### chessPlayMove<!-- {{#callable:chessPlayMove}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L93>)

Executes a move in a chess game if the game is ongoing and the move is legal, updating the game state accordingly.
- **Inputs**:
    - ``c``: A pointer to a `chess` structure representing the current state of the chess game.
    - ``m``: A `move` structure representing the move to be played.
- **Logic and Control Flow**:
    - Check if the game is not in an ongoing state (`tsOngoing`); if not, return 1 to indicate failure.
    - Initialize a variable `found` to 0 to track if the move is legal.
    - Iterate through the list of current legal moves (`c->currentLegalMoves`).
    - For each move in the list, check if it matches the move `m` using [`moveEq`](<move.c.md#moveeq>).
    - If a match is found, set `found` to 1 and break the loop.
    - If `found` is still 0 after the loop, return 1 to indicate the move is illegal.
    - If the move is legal, use [`boardPlayMove`](<board.c.md#boardplaymove>) to apply the move to the current board and get a new board state.
    - Add the new board state to the board history (`c->boardHistory`).
    - Add the move to the move history (`c->moveHistory`).
    - Recalculate the game fields using [`chessCalculateFields`](<#chesscalculatefields>) to update the game state.
    - Return 0 to indicate the move was successfully played.
- **Output**: Returns 0 if the move is successfully played, or 1 if the game is not ongoing or the move is illegal.
- **Functions Called**:
    - [`moveEq`](<move.c.md#moveeq>)
    - [`boardPlayMove`](<board.c.md#boardplaymove>)
    - [`chessGetBoard`](<#chessgetboard>)
    - [`boardListAdd`](<boardlist.c.md#boardlistadd>)
    - [`moveListAdd`](<movelist.c.md#movelistadd>)
    - [`chessCalculateFields`](<#chesscalculatefields>)


---
### chessUndo<!-- {{#callable:chessUndo}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L122>)

Reverts the last move in a chess game if possible, updating the game state accordingly.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Check if there is only one board in the history, indicating no moves to undo; if so, return failure (1).
    - Check if the game is in a terminal state due to a draw claim (threefold repetition or 50-move rule); if so, reset the terminal state to ongoing.
    - If not in a draw-claimed terminal state, call [`boardListUndo`](<boardlist.c.md#boardlistundo>) to revert the last board state and [`moveListUndo`](<movelist.c.md#movelistundo>) to revert the last move.
    - Call [`chessCalculateFields`](<#chesscalculatefields>) to update the game state, including legal moves and terminal conditions.
    - Return success (0) after successfully undoing a move.
- **Output**: Returns 0 if the undo operation is successful, or 1 if there are no moves to undo.
- **Functions Called**:
    - [`boardListUndo`](<boardlist.c.md#boardlistundo>)
    - [`moveListUndo`](<movelist.c.md#movelistundo>)
    - [`chessCalculateFields`](<#chesscalculatefields>)


---
### chessGetPiece<!-- {{#callable:chessGetPiece}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L144>)

Retrieves the chess piece located at a specific square on the board.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
    - `s`: A `sq` type representing the specific square on the chess board from which to retrieve the piece.
- **Logic and Control Flow**:
    - Calls [`chessGetBoard`](<#chessgetboard>) with the `chess` pointer `c` to get the current board.
    - Calls [`boardGetPiece`](<board.c.md#boardgetpiece>) with the retrieved board and the square `s` to get the piece at that square.
    - Returns the piece obtained from [`boardGetPiece`](<board.c.md#boardgetpiece>).
- **Output**: Returns a `piece` type representing the chess piece located at the specified square `s` on the board.
- **Functions Called**:
    - [`boardGetPiece`](<board.c.md#boardgetpiece>)
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetPlayer<!-- {{#callable:chessGetPlayer}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L149>)

Returns the current player's color from the chess board.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Access the `currentPlayer` field from the returned board structure.
- **Output**: The function returns a `pieceColor` value indicating the current player's color.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetCastleState<!-- {{#callable:chessGetCastleState}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L154>)

Retrieves the castling state from the current board of a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Accesses the `castleState` attribute of the board returned by [`chessGetBoard`](<#chessgetboard>).
    - Returns the value of `castleState`.
- **Output**: Returns an 8-bit unsigned integer representing the castling state of the current board.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetEpTarget<!-- {{#callable:chessGetEpTarget}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L159>)

Retrieves the en passant target square from the current board state in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Accesses the `epTarget` field of the board returned by [`chessGetBoard`](<#chessgetboard>).
    - Returns the value of `epTarget`, which represents the en passant target square.
- **Output**: The en passant target square (`sq`) from the current board state.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetHalfMoveClock<!-- {{#callable:chessGetHalfMoveClock}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L164>)

Retrieves the half-move clock from the current board of a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Access the `halfMoveClock` field of the board returned by [`chessGetBoard`](<#chessgetboard>).
    - Return the value of `halfMoveClock`.
- **Output**: An unsigned integer representing the half-move clock of the current board.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetMoveNumber<!-- {{#callable:chessGetMoveNumber}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L169>)

Retrieves the current move number from the chess game state.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board state.
    - Access the `moveNumber` field from the returned board structure.
    - Return the value of `moveNumber`.
- **Output**: An unsigned integer representing the current move number in the chess game.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetMoveHistoryUci<!-- {{#callable:chessGetMoveHistoryUci}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L174>)

Converts the move history of a chess game to a UCI (Universal Chess Interface) formatted string.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetMoveHistory`](<#chessgetmovehistory>) with the input `c` to obtain the move history of the chess game.
    - Pass the result to the function [`moveListGetUciString`](<movelist.c.md#movelistgetucistring>) to convert the move history into a UCI formatted string.
    - Return the UCI formatted string.
- **Output**: A pointer to a character string containing the UCI formatted move history of the chess game.
- **Functions Called**:
    - [`moveListGetUciString`](<movelist.c.md#movelistgetucistring>)
    - [`chessGetMoveHistory`](<#chessgetmovehistory>)


---
### chessIsInCheck<!-- {{#callable:chessIsInCheck}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L179>)

Checks if the current player's king is in check on the chess board.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board state.
    - Call the function [`boardIsInCheck`](<board.c.md#boardisincheck>) with the board obtained from [`chessGetBoard`](<#chessgetboard>).
    - Return the result of [`boardIsInCheck`](<board.c.md#boardisincheck>), which indicates if the king is in check.
- **Output**: Returns a `uint8_t` value where 1 indicates the king is in check and 0 indicates it is not.
- **Functions Called**:
    - [`boardIsInCheck`](<board.c.md#boardisincheck>)
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessIsSquareAttacked<!-- {{#callable:chessIsSquareAttacked}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L185>)

Determines if a specific square on the chess board is attacked by the opponent's pieces.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
    - `s`: The square (`sq`) on the chess board to check for an attack.
- **Logic and Control Flow**:
    - Retrieve the current board from the `chess` structure using [`chessGetBoard`](<#chessgetboard>) function.
    - Determine the opponent's color based on the current player stored in the board.
    - Call [`boardIsSquareAttacked`](<board.c.md#boardissquareattacked>) with the board, the square `s`, and the opponent's color to check if the square is attacked.
- **Output**: Returns a `uint8_t` value indicating whether the square is attacked (non-zero) or not (zero).
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)
    - [`boardIsSquareAttacked`](<board.c.md#boardissquareattacked>)


---
### chessGetFen<!-- {{#callable:chessGetFen}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L191>)

Retrieves the FEN (Forsyth-Edwards Notation) string representation of the current board state in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls the [`chessGetBoard`](<#chessgetboard>) function with the `chess` pointer `c` to obtain the current board.
    - Passes the obtained board to the [`boardGetFen`](<board.c.md#boardgetfen>) function to get the FEN string.
    - Returns the FEN string obtained from [`boardGetFen`](<board.c.md#boardgetfen>).
- **Output**: A pointer to a character string containing the FEN representation of the current board state.
- **Functions Called**:
    - [`boardGetFen`](<board.c.md#boardgetfen>)
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessCanClaimDraw50<!-- {{#callable:chessCanClaimDraw50}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L196>)

Checks if a chess game can claim a draw based on the 50-move rule.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Check if the game's terminal state is `tsOngoing`.
    - Retrieve the `halfMoveClock` from the current board of the chess game.
    - Check if the `halfMoveClock` is greater than or equal to 100.
- **Output**: Returns `1` (true) if the game can claim a draw based on the 50-move rule, otherwise returns `0` (false).
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessCanClaimDrawThreefold<!-- {{#callable:chessCanClaimDrawThreefold}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L201>)

Checks if a player can claim a draw due to threefold repetition in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Check if the game is ongoing by evaluating if `c->terminal` is equal to `tsOngoing`.
    - Check if the number of repetitions (`c->repetitions`) is greater than or equal to 3.
    - Return the result of the logical AND operation between the two conditions.
- **Output**: Returns a `uint8_t` value indicating whether a draw can be claimed (1 if true, 0 if false).


---
### chessClaimDraw50<!-- {{#callable:chessClaimDraw50}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L206>)

Claims a draw in a chess game if the 50-move rule conditions are met.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Checks if a draw can be claimed using the [`chessCanClaimDraw50`](<#chesscanclaimdraw50>) function.
    - If a draw can be claimed, sets the `terminal` state of the chess game to `tsDrawClaimed50MoveRule`.
- **Output**: No output is returned; the function modifies the `terminal` state of the `chess` structure if the draw is claimed.
- **Functions Called**:
    - [`chessCanClaimDraw50`](<#chesscanclaimdraw50>)


---
### chessClaimDrawThreefold<!-- {{#callable:chessClaimDrawThreefold}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L212>)

Sets the game state to a draw due to threefold repetition if the conditions are met.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Checks if a draw can be claimed due to threefold repetition by calling [`chessCanClaimDrawThreefold`](<#chesscanclaimdrawthreefold>) with the `chess` pointer `c`.
    - If [`chessCanClaimDrawThreefold`](<#chesscanclaimdrawthreefold>) returns true, sets the `terminal` field of the `chess` structure to `tsDrawClaimedThreefold`.
- **Output**: No return value; modifies the `terminal` field of the `chess` structure if a draw is claimed.
- **Functions Called**:
    - [`chessCanClaimDrawThreefold`](<#chesscanclaimdrawthreefold>)


---
### chessCalculateFields<!-- {{#callable:chessCalculateFields}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L218>)

Calculates the current state of a chess game, including repetitions, legal moves, and terminal state.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current game state.
- **Logic and Control Flow**:
    - Retrieve the current board from the chess game using [`chessGetBoard`](<#chessgetboard>) function.
    - Initialize the repetition count to zero.
    - Iterate through the board history to count how many times the current board state has occurred.
    - Free the current list of legal moves if it exists.
    - Generate a new list of legal moves for the current board state using [`boardGenerateMoves`](<board.c.md#boardgeneratemoves>).
    - Check if there are no legal moves available; if so, determine if the game is in checkmate or stalemate and set the terminal state accordingly.
    - If legal moves exist, check for draw conditions such as fivefold repetition, 75-move rule, or insufficient material, and set the terminal state accordingly.
    - If none of the draw conditions are met and the terminal state is not a claimed draw, set the terminal state to ongoing.
- **Output**: Updates the `chess` structure with the number of repetitions, the list of current legal moves, and the terminal state of the game.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)
    - [`boardEqContext`](<board.c.md#boardeqcontext>)
    - [`moveListFree`](<movelist.c.md#movelistfree>)
    - [`boardGenerateMoves`](<board.c.md#boardgeneratemoves>)
    - [`boardIsInCheck`](<board.c.md#boardisincheck>)
    - [`boardIsInsufficientMaterial`](<board.c.md#boardisinsufficientmaterial>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)