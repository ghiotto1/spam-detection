<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Chess game implementation with functions for game state management, move execution, and draw claims.

# Purpose
This code implements a chess game engine in C. It provides functions to create and manage a chess game, including initializing a game from the standard starting position or a given FEN (Forsyth-Edwards Notation) string. The code defines a `chess` structure that maintains the state of the game, including the board history, move history, current legal moves, repetition count, and terminal state. The functions allow for playing and undoing moves, checking the game's terminal state, and retrieving various game attributes such as the current board, legal moves, and FEN representation.

The code includes functions to manage the lifecycle of a chess game, such as [`chessCreate`](<#chesscreate>), [`chessFree`](<#chessfree>), and [`chessInitInPlace`](<#chessinitinplace>). It also provides functions to interact with the game state, such as [`chessPlayMove`](<#chessplaymove>), [`chessUndo`](<#chessundo>), and [`chessCalculateFields`](<#chesscalculatefields>), which updates the game's state based on the current board configuration. The code supports detecting draw conditions like the fifty-move rule and threefold repetition, and it can claim these draws when applicable. The implementation relies on external components, such as `board` and `move` structures, which are included from the `chesslib` library, indicating that this code is part of a larger chess software system.
# Imports and Dependencies

---
- `stdlib.h`
- `chesslib/chess.h`
- `chesslib/move.h`


# Functions

---
### chessCreate<!-- {{#callable:chessCreate}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L11>)

Creates a new chess game instance initialized to the standard starting position.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the [`chessCreateFen`](<#chesscreatefen>) function with `INITIAL_FEN` as the argument.
    - Returns the result of the [`chessCreateFen`](<#chesscreatefen>) function call.
- **Output**: A pointer to a `chess` structure representing a new chess game initialized to the standard starting position, or `NULL` if initialization fails.
- **Functions Called**:
    - [`chessCreateFen`](<#chesscreatefen>)


---
### chessCreateFen<!-- {{#callable:chessCreateFen}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L16>)

Creates a new `chess` object initialized with a given FEN string.
- **Inputs**:
    - `fen`: A string representing the board position in Forsyth-Edwards Notation (FEN).
- **Logic and Control Flow**:
    - Allocate memory for a new `chess` object `c`.
    - Call [`chessInitFenInPlace`](<#chessinitfeninplace>) to initialize `c` with the FEN string `fen`.
    - If [`chessInitFenInPlace`](<#chessinitfeninplace>) returns a non-zero value, free the allocated memory for `c` and return `NULL`.
    - If initialization is successful, return the pointer to the `chess` object `c`.
- **Output**: A pointer to a newly created `chess` object initialized with the FEN string, or `NULL` if initialization fails.
- **Functions Called**:
    - [`chessInitFenInPlace`](<#chessinitfeninplace>)


---
### chessInitInPlace<!-- {{#callable:chessInitInPlace}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L29>)

Initializes a `chess` structure with the initial chess position using the FEN string.
- **Inputs**:
    - `c`: A pointer to a `chess` structure that will be initialized.
- **Logic and Control Flow**:
    - Calls the function [`chessInitFenInPlace`](<#chessinitfeninplace>) with the `chess` structure pointer `c` and the constant `INITIAL_FEN` to set up the initial chess position.
- **Output**: No output is returned as the function is of type `void`.
- **Functions Called**:
    - [`chessInitFenInPlace`](<#chessinitfeninplace>)


---
### chessInitFenInPlace<!-- {{#callable:chessInitFenInPlace}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L34>)

Initializes a `chess` structure with a board state from a FEN string and sets up related game state fields.
- **Inputs**:
    - `c`: A pointer to a `chess` structure to initialize.
    - `fen`: A string representing the board state in Forsyth-Edwards Notation (FEN).
- **Logic and Control Flow**:
    - Create a `board` from the FEN string using [`boardCreateFromFen`](<board.c.md#boardcreatefromfen>).
    - If the board creation fails, return 1 to indicate an error.
    - Initialize `c->boardHistory` with a new board list and add the created board to it.
    - Initialize `c->moveHistory` with a new move list.
    - Set `c->currentLegalMoves` to NULL, `c->repetitions` to 1, and `c->terminal` to `tsOngoing`.
    - Call [`chessCalculateFields`](<#chesscalculatefields>) to compute repetitions and terminal state.
    - Return 0 to indicate successful initialization.
- **Output**: Returns 0 on successful initialization, or 1 if board creation fails.
- **Functions Called**:
    - [`boardCreateFromFen`](<board.c.md#boardcreatefromfen>)
    - [`boardListCreate`](<boardlist.c.md#boardlistcreate>)
    - [`boardListAdd`](<boardlist.c.md#boardlistadd>)
    - [`moveListCreate`](<movelist.c.md#movelistcreate>)
    - [`chessCalculateFields`](<#chesscalculatefields>)


---
### chessFree<!-- {{#callable:chessFree}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L55>)

Releases memory allocated for a `chess` structure and its associated lists.
- **Inputs**:
    - `c`: A pointer to a `chess` structure to be freed.
- **Logic and Control Flow**:
    - Call [`boardListFree`](<boardlist.c.md#boardlistfree>) to free the `boardHistory` list in the `chess` structure.
    - Call [`moveListFree`](<movelist.c.md#movelistfree>) to free the `moveHistory` list in the `chess` structure.
    - Call [`moveListFree`](<movelist.c.md#movelistfree>) to free the `currentLegalMoves` list in the `chess` structure.
    - Call `free` to release the memory allocated for the `chess` structure itself.
- **Output**: No return value; the function performs memory deallocation.
- **Functions Called**:
    - [`boardListFree`](<boardlist.c.md#boardlistfree>)
    - [`moveListFree`](<movelist.c.md#movelistfree>)


---
### chessGetBoard<!-- {{#callable:chessGetBoard}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L63>)

Retrieves the current board state from the chess game's board history.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `boardHistory` member of the `chess` structure `c`.
    - Retrieves the `tail` node of the `boardHistory` linked list.
    - Returns the `board` from the `tail` node.
- **Output**: A pointer to a `board` structure representing the current board state of the chess game.


---
### chessGetLegalMoves<!-- {{#callable:chessGetLegalMoves}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L68>)

Returns the list of current legal moves for a given chess game state.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `currentLegalMoves` field of the `chess` structure `c`.
    - Returns the value of `currentLegalMoves`, which is a pointer to a `moveList` structure.
- **Output**: A pointer to a `moveList` structure containing the current legal moves for the chess game.


---
### chessGetTerminalState<!-- {{#callable:chessGetTerminalState}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L73>)

Retrieves the terminal state of a chess game from a `chess` structure.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of a chess game.
- **Logic and Control Flow**:
    - Accesses the `terminal` field of the `chess` structure pointed to by `c`.
    - Returns the value of the `terminal` field.
- **Output**: The function returns a `terminalState` value, which indicates the current terminal state of the chess game (e.g., ongoing, checkmate, stalemate, etc.).


---
### chessGetBoardHistory<!-- {{#callable:chessGetBoardHistory}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L78>)

Retrieves the history of board states in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `boardHistory` member of the `chess` structure `c`.
    - Returns the `boardHistory`, which is a list of board states.
- **Output**: A pointer to a `boardList` structure that contains the history of board states.


---
### chessGetMoveHistory<!-- {{#callable:chessGetMoveHistory}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L83>)

Retrieves the move history from a chess game instance.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of a chess game.
- **Logic and Control Flow**:
    - Accesses the `moveHistory` member of the `chess` structure pointed to by `c`.
    - Returns the `moveHistory` which is a pointer to a `moveList` structure.
- **Output**: A pointer to a `moveList` structure containing the history of moves made in the chess game.


---
### chessGetRepetitions<!-- {{#callable:chessGetRepetitions}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L88>)

Retrieves the number of times the current board position has been repeated in the game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Accesses the `repetitions` field of the `chess` structure pointed to by `c`.
    - Returns the value of the `repetitions` field.
- **Output**: Returns an 8-bit unsigned integer representing the number of repetitions of the current board position.


---
### chessPlayMove<!-- {{#callable:chessPlayMove}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L93>)

Executes a move in a chess game if the game is ongoing and the move is legal, updating the game state accordingly.
- **Inputs**:
    - ``c``: A pointer to a `chess` structure representing the current state of the chess game.
    - ``m``: A `move` structure representing the move to be played.
- **Logic and Control Flow**:
    - Check if the game is not in an ongoing state (`tsOngoing`); if not, return 1 to indicate failure.
    - Initialize a variable `found` to 0 to track if the move is legal.
    - Iterate through the list of current legal moves in `c->currentLegalMoves`.
    - For each move in the list, check if it matches the move `m` using [`moveEq`](<move.c.md#moveeq>).
    - If a match is found, set `found` to 1 and break the loop.
    - If `found` is still 0 after the loop, return 1 to indicate the move is illegal.
    - If the move is legal, use [`boardPlayMove`](<board.c.md#boardplaymove>) to apply the move to the current board and get a new board state.
    - Add the new board state to the board history using [`boardListAdd`](<boardlist.c.md#boardlistadd>).
    - Add the move to the move history using [`moveListAdd`](<movelist.c.md#movelistadd>).
    - Recalculate the game fields using [`chessCalculateFields`](<#chesscalculatefields>) to update the game state.
    - Return 0 to indicate success.
- **Output**: Returns 0 if the move is successfully played, or 1 if the move is illegal or the game is not ongoing.
- **Functions Called**:
    - [`moveEq`](<move.c.md#moveeq>)
    - [`boardPlayMove`](<board.c.md#boardplaymove>)
    - [`chessGetBoard`](<#chessgetboard>)
    - [`boardListAdd`](<boardlist.c.md#boardlistadd>)
    - [`moveListAdd`](<movelist.c.md#movelistadd>)
    - [`chessCalculateFields`](<#chesscalculatefields>)


---
### chessUndo<!-- {{#callable:chessUndo}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L122>)

Reverts the last move in a chess game if possible.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Checks if there is only one board in the history, indicating no moves to undo, and returns failure if true.
    - If the game is in a terminal state due to a draw claim (threefold repetition or 50-move rule), resets the terminal state to ongoing.
    - Otherwise, calls [`boardListUndo`](<boardlist.c.md#boardlistundo>) to remove the last board from the history and [`moveListUndo`](<movelist.c.md#movelistundo>) to remove the last move from the move history.
    - Recalculates the game fields by calling [`chessCalculateFields`](<#chesscalculatefields>).
- **Output**: Returns `0` on success (move undone) and `1` on failure (no move to undo).
- **Functions Called**:
    - [`boardListUndo`](<boardlist.c.md#boardlistundo>)
    - [`moveListUndo`](<movelist.c.md#movelistundo>)
    - [`chessCalculateFields`](<#chesscalculatefields>)


---
### chessGetPiece<!-- {{#callable:chessGetPiece}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L144>)

Retrieves the chess piece located at a specific square on the board.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
    - `s`: A `sq` type representing the square on the chess board from which to retrieve the piece.
- **Logic and Control Flow**:
    - Calls [`chessGetBoard`](<#chessgetboard>) with the `chess` pointer `c` to get the current board.
    - Calls [`boardGetPiece`](<board.c.md#boardgetpiece>) with the retrieved board and the square `s` to get the piece at that square.
    - Returns the piece obtained from [`boardGetPiece`](<board.c.md#boardgetpiece>).
- **Output**: Returns a `piece` type representing the chess piece at the specified square `s` on the board.
- **Functions Called**:
    - [`boardGetPiece`](<board.c.md#boardgetpiece>)
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetPlayer<!-- {{#callable:chessGetPlayer}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L149>)

Returns the current player's color from the chess board.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Access the `currentPlayer` field from the returned board structure.
    - Return the value of `currentPlayer`, which indicates the color of the current player.
- **Output**: The function returns a `pieceColor` value representing the color of the current player.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetCastleState<!-- {{#callable:chessGetCastleState}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L154>)

Retrieves the castling state from the current board of a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Access the `castleState` attribute of the board returned by [`chessGetBoard`](<#chessgetboard>).
    - Return the `castleState` value.
- **Output**: Returns an 8-bit unsigned integer representing the castling state of the current board.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetEpTarget<!-- {{#callable:chessGetEpTarget}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L159>)

Retrieves the en passant target square from the current board state in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls the function [`chessGetBoard`](<#chessgetboard>) with the `chess` pointer `c` to get the current board.
    - Accesses the `epTarget` field of the board returned by [`chessGetBoard`](<#chessgetboard>).
    - Returns the value of `epTarget`, which represents the en passant target square.
- **Output**: The en passant target square (`sq`) from the current board state.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetHalfMoveClock<!-- {{#callable:chessGetHalfMoveClock}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L164>)

Retrieves the half-move clock from the current board of a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board.
    - Access the `halfMoveClock` field of the board returned by [`chessGetBoard`](<#chessgetboard>).
    - Return the value of `halfMoveClock`.
- **Output**: An unsigned integer representing the half-move clock of the current board.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetMoveNumber<!-- {{#callable:chessGetMoveNumber}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L169>)

Retrieves the current move number from the chess game state.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls the function [`chessGetBoard`](<#chessgetboard>) with the `chess` pointer `c` to get the current board state.
    - Accesses the `moveNumber` field from the board structure returned by [`chessGetBoard`](<#chessgetboard>).
    - Returns the value of `moveNumber`.
- **Output**: The function returns an `unsigned int` representing the current move number in the chess game.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessGetMoveHistoryUci<!-- {{#callable:chessGetMoveHistoryUci}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L174>)

Returns the move history of a chess game in UCI (Universal Chess Interface) format.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls [`chessGetMoveHistory`](<#chessgetmovehistory>) with the `chess` pointer `c` to retrieve the move history as a `moveList` object.
    - Passes the retrieved `moveList` to [`moveListGetUciString`](<movelist.c.md#movelistgetucistring>) to convert the move history into a UCI format string.
    - Returns the UCI format string.
- **Output**: A string representing the move history of the chess game in UCI format.
- **Functions Called**:
    - [`moveListGetUciString`](<movelist.c.md#movelistgetucistring>)
    - [`chessGetMoveHistory`](<#chessgetmovehistory>)


---
### chessIsInCheck<!-- {{#callable:chessIsInCheck}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L179>)

Checks if the current player's king is in check on the chess board.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Call the function [`chessGetBoard`](<#chessgetboard>) with the input `c` to get the current board state.
    - Call the function [`boardIsInCheck`](<board.c.md#boardisincheck>) with the board obtained from the previous step.
    - Return the result from [`boardIsInCheck`](<board.c.md#boardisincheck>).
- **Output**: Returns a `uint8_t` value indicating whether the king is in check (non-zero) or not (zero).
- **Functions Called**:
    - [`boardIsInCheck`](<board.c.md#boardisincheck>)
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessIsSquareAttacked<!-- {{#callable:chessIsSquareAttacked}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L185>)

Checks if a square on the chessboard is attacked by the opponent's pieces.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
    - `s`: The square (`sq`) on the chessboard to check for an attack.
- **Logic and Control Flow**:
    - Retrieve the current board from the `chess` structure using [`chessGetBoard`](<#chessgetboard>) function.
    - Determine the opponent's color based on the current player on the board.
    - Call [`boardIsSquareAttacked`](<board.c.md#boardissquareattacked>) with the board, square, and opponent's color to check if the square is attacked.
- **Output**: Returns a `uint8_t` value indicating whether the square is attacked (non-zero) or not (zero).
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)
    - [`boardIsSquareAttacked`](<board.c.md#boardissquareattacked>)


---
### chessGetFen<!-- {{#callable:chessGetFen}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L191>)

Retrieves the FEN (Forsyth-Edwards Notation) string representation of the current board state in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Calls the [`chessGetBoard`](<#chessgetboard>) function with the `chess` pointer `c` to obtain the current board.
    - Passes the obtained board to the [`boardGetFen`](<board.c.md#boardgetfen>) function to get the FEN string.
    - Returns the FEN string obtained from [`boardGetFen`](<board.c.md#boardgetfen>).
- **Output**: A pointer to a character string containing the FEN representation of the current board state.
- **Functions Called**:
    - [`boardGetFen`](<board.c.md#boardgetfen>)
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessCanClaimDraw50<!-- {{#callable:chessCanClaimDraw50}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L196>)

Checks if a chess game can claim a draw based on the 50-move rule.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Checks if the game's terminal state is `tsOngoing`.
    - Retrieves the current board from the chess game using `chessGetBoard(c)`.
    - Checks if the `halfMoveClock` of the board is greater than or equal to 100.
- **Output**: Returns `1` (true) if the game can claim a draw based on the 50-move rule, otherwise returns `0` (false).
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)


---
### chessCanClaimDrawThreefold<!-- {{#callable:chessCanClaimDrawThreefold}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L201>)

Checks if a player can claim a draw due to threefold repetition in a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Check if the game is ongoing by evaluating if `c->terminal` is equal to `tsOngoing`.
    - Check if the number of repetitions (`c->repetitions`) is greater than or equal to 3.
    - Return the result of the logical AND operation between the two conditions.
- **Output**: Returns a `uint8_t` value that is non-zero if a draw can be claimed due to threefold repetition, otherwise returns zero.


---
### chessClaimDraw50<!-- {{#callable:chessClaimDraw50}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L206>)

Claims a draw in a chess game if the 50-move rule conditions are met.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Check if the 50-move draw can be claimed by calling [`chessCanClaimDraw50`](<#chesscanclaimdraw50>) with the chess game state `c`.
    - If [`chessCanClaimDraw50`](<#chesscanclaimdraw50>) returns true, set the `terminal` field of the chess game state `c` to `tsDrawClaimed50MoveRule`.
- **Output**: No return value; modifies the `terminal` field of the `chess` structure if the draw is claimed.
- **Functions Called**:
    - [`chessCanClaimDraw50`](<#chesscanclaimdraw50>)


---
### chessClaimDrawThreefold<!-- {{#callable:chessClaimDrawThreefold}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L212>)

Sets the game state to a draw due to threefold repetition if the conditions are met.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Checks if a draw can be claimed due to threefold repetition by calling [`chessCanClaimDrawThreefold`](<#chesscanclaimdrawthreefold>) with the `chess` pointer `c`.
    - If [`chessCanClaimDrawThreefold`](<#chesscanclaimdrawthreefold>) returns true, sets the `terminal` field of the `chess` structure to `tsDrawClaimedThreefold`.
- **Output**: No return value; modifies the `terminal` field of the `chess` structure if conditions are met.
- **Functions Called**:
    - [`chessCanClaimDrawThreefold`](<#chesscanclaimdrawthreefold>)


---
### chessCalculateFields<!-- {{#callable:chessCalculateFields}} -->
[View Source →](<../../../../../chesslib/src/chesslib/chess.c#L218>)

Calculates the number of board repetitions, generates legal moves, and determines the terminal state of a chess game.
- **Inputs**:
    - `c`: A pointer to a `chess` structure representing the current state of the chess game.
- **Logic and Control Flow**:
    - Retrieve the current board from the chess game using [`chessGetBoard`](<#chessgetboard>) and store it in `currentBoard`.
    - Initialize the `repetitions` counter to 0.
    - Iterate through the board history linked list to count how many times the current board state has occurred, updating `repetitions`.
    - If `currentLegalMoves` is not NULL, free the existing move list using [`moveListFree`](<movelist.c.md#movelistfree>).
    - Generate the list of legal moves for the current board and assign it to `currentLegalMoves`.
    - If there are no legal moves, check if the current player is in check to set the terminal state to `tsCheckmate` or `tsDrawStalemate`.
    - If there are legal moves, check for draw conditions such as fivefold repetition, 75-move rule, insufficient material, or ongoing state, and update the terminal state accordingly.
- **Output**: The function updates the `repetitions`, `currentLegalMoves`, and `terminal` fields of the `chess` structure `c`.
- **Functions Called**:
    - [`chessGetBoard`](<#chessgetboard>)
    - [`boardEqContext`](<board.c.md#boardeqcontext>)
    - [`moveListFree`](<movelist.c.md#movelistfree>)
    - [`boardGenerateMoves`](<board.c.md#boardgeneratemoves>)
    - [`boardIsInCheck`](<board.c.md#boardisincheck>)
    - [`boardIsInsufficientMaterial`](<board.c.md#boardisinsufficientmaterial>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)