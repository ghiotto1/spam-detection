<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

The `xmalloc.h` file in the `spam-detection` codebase provides custom memory allocation functions that ensure error checking and never return failure, calling a fatal error handler instead.

# Purpose
This C header file, `xmalloc.h`, provides declarations for a set of memory allocation and string manipulation functions that enhance standard C library functions by incorporating error checking and handling. The functions, such as [`xmalloc`](<#xmalloc>), [`xcalloc`](<#xcalloc>), [`xrealloc`](<#xrealloc>), and others, are designed to never return a failure; instead, they invoke a fatal error handler if an error occurs, ensuring robust memory management. Additionally, the file includes safer versions of string duplication and formatted output functions, like [`xstrdup`](<#xstrdup>) and [`xasprintf`](<#xasprintf>), which include attributes for format checking and non-null constraints to prevent common programming errors. This header is part of a larger software project, likely related to secure communications, as indicated by the author's note on usage and compatibility with the SSH protocol.
# Function Declarations (Public API)

---
### xmalloc<!-- {{#callable_declaration:xmalloc}} -->
[View Source ↗](<../../xmalloc.h#L26>)

Allocate memory and ensure allocation success.
- **Description**: This function allocates a block of memory of the specified size and ensures that the allocation is successful. It should be used when you need to allocate memory and want to avoid handling allocation failures manually. If the requested size is zero or if the allocation fails, the function will terminate the program with an error message. This function is useful in scenarios where memory allocation failure is considered a critical error and should not be handled by the caller.
- **Inputs**:
    - `size`: The number of bytes to allocate. Must be greater than zero. If zero is passed, the function will terminate the program with an error message.
- **Output**: A pointer to the allocated memory block. The function does not return on failure; it terminates the program instead.
- **See also**: [`xmalloc`](<xmalloc.c.md#xmalloc>)  (Implementation)


---
### xcalloc<!-- {{#callable_declaration:xcalloc}} -->
[View Source ↗](<../../xmalloc.h#L27>)

Allocates and zeroes memory for an array.
- **Description**: This function allocates memory for an array of `nmemb` elements, each of `size` bytes, and initializes all bytes in the allocated storage to zero. It is designed to be used when you need a guaranteed allocation without having to handle allocation failures, as it will terminate the program if the allocation fails or if either `nmemb` or `size` is zero. This function is useful in scenarios where memory allocation is critical and failure is not an option, such as in system-level programming or critical applications.
- **Inputs**:
    - `nmemb`: The number of elements to allocate. Must be greater than zero. If zero, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero. If zero, the function will terminate the program.
- **Output**: A pointer to the allocated memory, which is zero-initialized. The program will terminate if the allocation fails.
- **See also**: [`xcalloc`](<xmalloc.c.md#xcalloc>)  (Implementation)


---
### xrealloc<!-- {{#callable_declaration:xrealloc}} -->
[View Source ↗](<../../xmalloc.h#L28>)

Reallocate memory to a new size, ensuring success or terminating the program.
- **Description**: This function is used to resize a previously allocated memory block to a new size specified by the user. It is particularly useful when the size of the data structure needs to be adjusted dynamically. The function guarantees that the reallocation will succeed; if it encounters an error, it will terminate the program. This behavior ensures that the caller does not need to handle memory allocation failures, simplifying error handling in applications where such failures are critical. It should be used when the program cannot continue without successfully reallocating memory.
- **Inputs**:
    - `ptr`: A pointer to the memory block previously allocated with xmalloc, xcalloc, or xrealloc. It can be NULL, in which case the function behaves like xmalloc.
    - `size`: The new size in bytes for the memory block. Must be greater than zero. If the size is zero, the behavior is undefined, and the function may terminate the program.
- **Output**: Returns a pointer to the newly allocated memory block, which is guaranteed to be non-NULL. The contents of the memory block are unchanged up to the lesser of the new and old sizes.
- **See also**: [`xrealloc`](<xmalloc.c.md#xrealloc>)  (Implementation)


---
### xreallocarray<!-- {{#callable_declaration:xreallocarray}} -->
[View Source ↗](<../../xmalloc.h#L29>)

Reallocate memory for an array, ensuring allocation success.
- **Description**: This function reallocates memory for an array with a specified number of elements and element size, ensuring that the allocation is successful. It should be used when you need to resize an existing memory block pointed to by `ptr` to accommodate `nmemb` elements of `size` bytes each. If either `nmemb` or `size` is zero, the function will terminate the program with an error message. Similarly, if the memory allocation fails, the function will also terminate the program with an error message. This function is useful in scenarios where memory allocation failures are considered critical and should not be handled by the caller.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. It can be NULL, in which case the function behaves like `xmalloc`.
    - `nmemb`: The number of elements to allocate. Must be greater than zero; otherwise, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero; otherwise, the function will terminate the program.
- **Output**: Returns a pointer to the newly allocated memory block. The program will terminate if allocation fails.
- **See also**: [`xreallocarray`](<xmalloc.c.md#xreallocarray>)  (Implementation)


---
### xrecallocarray<!-- {{#callable_declaration:xrecallocarray}} -->
[View Source ↗](<../../xmalloc.h#L30>)

Reallocate and zero-initialize an array, ensuring allocation success.
- **Description**: This function reallocates an array to a new size, ensuring that the newly allocated memory is zero-initialized. It is designed to handle memory allocation failures by terminating the program if the allocation cannot be completed. This function should be used when you need to resize an array and want to ensure that any new memory is zeroed out, providing a safer alternative to standard reallocation functions that may return NULL on failure. It is important to note that this function will terminate the program if either the new number of elements or the size of each element is zero, or if the memory allocation fails.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. This can be NULL, in which case the function behaves like a call to xcalloc.
    - `oldnmemb`: The number of elements in the current memory block. Must be a valid size_t value.
    - `nmemb`: The number of elements in the new memory block. Must be greater than zero; otherwise, the function will terminate the program.
    - `size`: The size of each element in the new memory block. Must be greater than zero; otherwise, the function will terminate the program.
- **Output**: Returns a pointer to the newly allocated and zero-initialized memory block. The program will terminate if allocation fails.
- **See also**: [`xrecallocarray`](<xmalloc.c.md#xrecallocarray>)  (Implementation)


---
### xstrdup<!-- {{#callable_declaration:xstrdup}} -->
[View Source ↗](<../../xmalloc.h#L31>)

Duplicates a string with error handling.
- **Description**: This function creates a duplicate of the given string, ensuring that memory allocation is successful. It should be used when a copy of a string is needed and the program cannot continue if memory allocation fails. The function will terminate the program with an error message if it encounters an allocation failure, making it suitable for use in applications where such failures are considered fatal.
- **Inputs**:
    - `str`: A pointer to a null-terminated string that is to be duplicated. Must not be null, as passing a null pointer will result in undefined behavior.
- **Output**: Returns a pointer to the newly allocated string, which is a duplicate of the input string. The caller is responsible for freeing the allocated memory.
- **See also**: [`xstrdup`](<xmalloc.c.md#xstrdup>)  (Implementation)


---
### xstrndup<!-- {{#callable_declaration:xstrndup}} -->
[View Source ↗](<../../xmalloc.h#L32>)

Duplicates a string up to a specified maximum length, ensuring successful allocation.
- **Description**: This function creates a duplicate of the input string, copying at most 'maxlen' characters, and ensures that memory allocation is successful. It is useful when you need a copy of a string with a limited length, and you want to avoid handling allocation failures manually. The function will terminate the program if memory allocation fails, so it should be used in contexts where such behavior is acceptable.
- **Inputs**:
    - `str`: The input string to be duplicated. Must not be null, as the function does not handle null pointers.
    - `maxlen`: The maximum number of characters to copy from the input string. Must be a non-negative value.
- **Output**: Returns a pointer to the newly allocated string containing up to 'maxlen' characters from the input string. The caller is responsible for freeing the allocated memory.
- **See also**: [`xstrndup`](<xmalloc.c.md#xstrndup>)  (Implementation)


---
### xasprintf<!-- {{#callable_declaration:xasprintf}} -->
[View Source ↗](<../../xmalloc.h#L33>)

Formats a string and allocates memory for it.
- **Description**: This function formats a string according to the specified format string and additional arguments, allocating memory for the resulting string. It is similar to `asprintf`, but guarantees that memory allocation will not fail, as it will terminate the program on allocation failure. This function should be used when you need a formatted string and want to ensure that memory allocation errors are handled by terminating the program. The function must be called with a valid format string, and the caller is responsible for freeing the allocated memory pointed to by `ret`.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string as in printf. Must not be null. It specifies how the subsequent arguments are converted for output.
    - `...`: Additional arguments that are formatted according to the format string. The number and types of these arguments must match the format specifiers in `fmt`.
- **Output**: Returns the number of characters printed (excluding the null byte used to end output to strings).
- **See also**: [`xasprintf`](<xmalloc.c.md#xasprintf>)  (Implementation)


---
### xvasprintf<!-- {{#callable_declaration:xvasprintf}} -->
[View Source ↗](<../../xmalloc.h#L36>)

Formats a string and allocates memory for it, ensuring no failure occurs.
- **Description**: This function formats a string according to the specified format and arguments, allocating memory for the resulting string. It is used when you need a formatted string with dynamic memory allocation, and it ensures that memory allocation failures are handled by terminating the program. This function should be called when you want to safely format a string without manually handling memory allocation errors. The function must be provided with a valid format string and a va_list of arguments corresponding to the format specifiers.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string as in printf. Must not be null and should be a valid format string.
    - `ap`: A va_list of arguments that correspond to the format specifiers in fmt. It should be properly initialized before calling this function.
- **Output**: Returns the number of characters printed (excluding the null byte used to end output) or terminates the program if memory allocation fails.
- **See also**: [`xvasprintf`](<xmalloc.c.md#xvasprintf>)  (Implementation)


---
### xsnprintf<!-- {{#callable_declaration:xsnprintf}} -->
[View Source ↗](<../../xmalloc.h#L39>)

Formats a string and stores it in a buffer.
- **Description**: This function formats a string according to the specified format string and stores the result in the provided buffer. It is similar to snprintf but includes additional safety checks. The function must be called with a valid format string and a buffer that is large enough to hold the resulting formatted string, including the null terminator. The function ensures that the buffer is not overflowed by limiting the number of characters written based on the specified length. It is important to ensure that the format string is not null, as this will lead to undefined behavior.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be stored. The buffer must be large enough to hold the resulting string, including the null terminator. The caller retains ownership of the buffer.
    - `len`: The maximum number of bytes to be written to the buffer, including the null terminator. Must be greater than zero to ensure space for the null terminator.
    - `fmt`: A non-null format string that specifies how to format the data. It follows the same specifications as the format string in printf.
- **Output**: Returns the number of characters that would have been written if the buffer had been large enough, not counting the null terminator. If the return value is greater than or equal to the specified length, the output was truncated.
- **See also**: [`xsnprintf`](<xmalloc.c.md#xsnprintf>)  (Implementation)


---
### xvsnprintf<!-- {{#callable_declaration:xvsnprintf}} -->
[View Source ↗](<../../xmalloc.h#L43>)

Formats a string into a buffer using a variable argument list.
- **Description**: This function formats a string according to the specified format string and variable argument list, writing the result into the provided buffer. It is used when you need to format a string with arguments that are passed as a `va_list`. The function ensures that the formatted string does not exceed the specified buffer length, and it will terminate the program if the buffer length exceeds `INT_MAX` or if the formatted string would overflow the buffer. This function should be used when you want to safely format strings without handling errors manually, as it will handle any potential overflows by terminating the program.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be written. The buffer must be large enough to hold the resulting string, including the null terminator. The caller retains ownership and must ensure it is not null.
    - `len`: The maximum number of bytes to write to the buffer, including the null terminator. Must not exceed `INT_MAX`. If it does, the program will terminate.
    - `fmt`: A format string that specifies how to format the arguments. Must not be null.
    - `ap`: A `va_list` containing the arguments to format according to the format string. The caller is responsible for initializing and managing the `va_list`.
- **Output**: Returns the number of characters that would have been written if the buffer had been large enough, not counting the null terminator. If the return value is negative or greater than or equal to `len`, the program will terminate.
- **See also**: [`xvsnprintf`](<xmalloc.c.md#xvsnprintf>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)