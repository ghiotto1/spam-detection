<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

The `xmalloc.h` file in the `spam-detection` codebase provides custom memory allocation functions that ensure successful allocation by checking results and handling errors.

# Purpose
This C header file, `xmalloc.h`, provides declarations for a set of memory management and string manipulation functions that enhance standard C library functions by incorporating error checking and handling. The functions, such as [`xmalloc`](<#xmalloc>), [`xcalloc`](<#xcalloc>), [`xrealloc`](<#xrealloc>), and [`xstrdup`](<#xstrdup>), are designed to never return a failure; instead, they invoke a fatal error handler if an error occurs, ensuring robust memory allocation. Additionally, the file includes safer versions of formatted output functions like [`xasprintf`](<#xasprintf>) and [`xsnprintf`](<#xsnprintf>), which include attributes for format string checking and non-null parameters to prevent common errors. This header is part of a larger software project, likely related to secure shell (SSH) development, as indicated by the author's note on usage and compatibility with protocol descriptions.
# Function Declarations (Public API)

---
### xmalloc<!-- {{#callable_declaration:xmalloc}} -->
[üîó View Source](<../../xmalloc.h#L26>)

Allocate memory and ensure allocation success.
- **Description**: This function allocates a block of memory of the specified size and guarantees that the allocation is successful. It should be used when memory allocation is critical and failure is not an option, as it will terminate the program if the allocation fails or if a zero size is requested. This function is suitable for applications where robustness is prioritized over handling allocation failures gracefully.
- **Inputs**:
    - `size`: The number of bytes to allocate. Must be greater than zero. If zero is provided, the function will terminate the program.
- **Output**: A pointer to the allocated memory block. The program will terminate if the allocation fails.
- **See also**: [`xmalloc`](<xmalloc.c.md#xmalloc>)  (Implementation)


---
### xcalloc<!-- {{#callable_declaration:xcalloc}} -->
[üîó View Source](<../../xmalloc.h#L27>)

Allocates and zeroes memory for an array.
- **Description**: This function allocates memory for an array of `nmemb` elements, each of `size` bytes, and initializes all bytes in the allocated storage to zero. It should be used when you need a zero-initialized memory block for an array. The function will terminate the program if the allocation fails or if either `nmemb` or `size` is zero, ensuring that it never returns a null pointer.
- **Inputs**:
    - `nmemb`: The number of elements to allocate. Must be greater than zero. If zero, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero. If zero, the function will terminate the program.
- **Output**: A pointer to the allocated memory, which is zero-initialized. The program will terminate if allocation fails.
- **See also**: [`xcalloc`](<xmalloc.c.md#xcalloc>)  (Implementation)


---
### xrealloc<!-- {{#callable_declaration:xrealloc}} -->
[üîó View Source](<../../xmalloc.h#L28>)

Reallocate memory to a new size, ensuring success or terminating the program.
- **Description**: This function is used to resize a previously allocated memory block to a new size specified by the user. It is particularly useful when the size of the data structure needs to be adjusted dynamically. The function guarantees that it will not return a null pointer; instead, it will terminate the program if the reallocation fails. This behavior ensures that the caller does not need to check for null pointers, simplifying error handling in the code. It should be used when the program cannot continue without successfully reallocating memory.
- **Inputs**:
    - `ptr`: A pointer to the memory block previously allocated with xmalloc, xcalloc, or xrealloc. It can be null, in which case the function behaves like xmalloc.
    - `size`: The new size in bytes for the memory block. It must be a positive value. If the size is zero, the behavior is implementation-defined, but typically it frees the memory.
- **Output**: A pointer to the reallocated memory block, which is guaranteed to be non-null.
- **See also**: [`xrealloc`](<xmalloc.c.md#xrealloc>)  (Implementation)


---
### xreallocarray<!-- {{#callable_declaration:xreallocarray}} -->
[üîó View Source](<../../xmalloc.h#L29>)

Reallocate memory for an array, ensuring allocation success.
- **Description**: This function reallocates memory for an array with a specified number of elements and element size, ensuring that the allocation is successful. It should be used when you need to resize an existing memory block pointed to by `ptr` to accommodate `nmemb` elements of `size` bytes each. If either `nmemb` or `size` is zero, the function will terminate the program with an error message. Similarly, if the memory allocation fails, the function will also terminate the program with an error message. This function is useful in scenarios where memory allocation failures are considered critical and should not be handled by the caller.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. It can be NULL, in which case the function behaves like `xmalloc` for the specified size.
    - `nmemb`: The number of elements to allocate. Must be greater than zero; otherwise, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero; otherwise, the function will terminate the program.
- **Output**: Returns a pointer to the newly allocated memory block, which is guaranteed to be non-NULL.
- **See also**: [`xreallocarray`](<xmalloc.c.md#xreallocarray>)  (Implementation)


---
### xrecallocarray<!-- {{#callable_declaration:xrecallocarray}} -->
[üîó View Source](<../../xmalloc.h#L30>)

Reallocate and zero-initialize an array, ensuring allocation success.
- **Description**: This function reallocates an array to a new size and ensures that any newly allocated memory is zero-initialized. It is designed to handle memory allocation failures by terminating the program if the allocation cannot be completed, thus guaranteeing that it never returns a null pointer. This function should be used when you need to resize an array and want to ensure that any new elements are initialized to zero. It is important to note that the function will terminate the program if either the number of elements or the size of each element is zero, as these are considered invalid inputs.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. This can be null, in which case the function behaves like a zero-initialized allocation.
    - `oldnmemb`: The number of elements in the current array. Must be a valid size_t value.
    - `nmemb`: The desired number of elements in the new array. Must be greater than zero, otherwise the function will terminate the program.
    - `size`: The size of each element in the array. Must be greater than zero, otherwise the function will terminate the program.
- **Output**: A pointer to the newly allocated and zero-initialized memory block. The program will terminate if allocation fails.
- **See also**: [`xrecallocarray`](<xmalloc.c.md#xrecallocarray>)  (Implementation)


---
### xstrdup<!-- {{#callable_declaration:xstrdup}} -->
[üîó View Source](<../../xmalloc.h#L31>)

Duplicates a string with error checking.
- **Description**: This function creates a duplicate of the given string, ensuring that memory allocation is successful. It should be used when a copy of a string is needed and the program cannot continue if memory allocation fails. The function will terminate the program with an error message if it encounters an allocation failure, making it suitable for use in applications where such failures are considered fatal.
- **Inputs**:
    - `str`: A pointer to a null-terminated string to be duplicated. Must not be null, as passing a null pointer will result in undefined behavior.
- **Output**: Returns a pointer to the newly allocated string, which is a duplicate of the input string. The caller is responsible for freeing the allocated memory.
- **See also**: [`xstrdup`](<xmalloc.c.md#xstrdup>)  (Implementation)


---
### xstrndup<!-- {{#callable_declaration:xstrndup}} -->
[üîó View Source](<../../xmalloc.h#L32>)

Duplicates a string up to a specified maximum length, ensuring successful allocation.
- **Description**: This function creates a duplicate of the input string, copying at most 'maxlen' characters, and ensures that memory allocation is successful. It is useful when you need a copy of a string with a limited length, and you want to avoid handling memory allocation failures manually. The function will terminate the program if memory allocation fails, so it should be used in contexts where such behavior is acceptable.
- **Inputs**:
    - `str`: The input string to be duplicated. Must not be null, as the function does not handle null pointers.
    - `maxlen`: The maximum number of characters to copy from the input string. Must be a non-negative value.
- **Output**: Returns a pointer to the newly allocated string containing up to 'maxlen' characters from the input string. The program will terminate if memory allocation fails.
- **See also**: [`xstrndup`](<xmalloc.c.md#xstrndup>)  (Implementation)


---
### xasprintf<!-- {{#callable_declaration:xasprintf}} -->
[üîó View Source](<../../xmalloc.h#L33>)

Formats a string and allocates memory for it.
- **Description**: This function formats a string according to the specified format string and additional arguments, allocating memory for the resulting string. It is similar to `asprintf`, but it never returns failure; instead, it calls a fatal error handler if memory allocation fails. This function should be used when you need a formatted string and want to ensure that memory allocation errors are handled internally. The caller is responsible for freeing the allocated memory when it is no longer needed.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string as in printf. Must not be null. It specifies how subsequent arguments are converted for output.
    - `...`: Additional arguments that are formatted according to the format string. The number and types of these arguments must match the format specifiers in the format string.
- **Output**: Returns the number of characters printed, excluding the null byte used to end output to strings.
- **See also**: [`xasprintf`](<xmalloc.c.md#xasprintf>)  (Implementation)


---
### xvasprintf<!-- {{#callable_declaration:xvasprintf}} -->
[üîó View Source](<../../xmalloc.h#L36>)

Formats a string and allocates memory for it, ensuring successful allocation.
- **Description**: This function formats a string according to the specified format string and variable argument list, allocating memory for the resulting string. It is used when you need to create a formatted string with dynamic content, ensuring that memory allocation is successful. If the allocation fails, the function will terminate the program. This function should be used when you want to ensure that memory allocation errors are handled by terminating the program, rather than returning an error code.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string that specifies how to format the variable arguments. Must not be null.
    - `ap`: A va_list representing the variable arguments to format according to the format string. It should be initialized before calling this function.
- **Output**: Returns the number of characters in the formatted string, excluding the null terminator. If memory allocation fails, the program is terminated.
- **See also**: [`xvasprintf`](<xmalloc.c.md#xvasprintf>)  (Implementation)


---
### xsnprintf<!-- {{#callable_declaration:xsnprintf}} -->
[üîó View Source](<../../xmalloc.h#L39>)

Formats a string and stores it in a buffer with size checking.
- **Description**: This function formats a string according to the specified format string and additional arguments, storing the result in the provided buffer. It is similar to snprintf but includes additional safety checks. The function ensures that the formatted string does not exceed the specified buffer length, preventing buffer overflows. It must be called with a valid format string and a buffer that is large enough to hold the resulting formatted string, including the null terminator. The function is designed to be used in situations where safety and correctness are critical, such as in secure applications.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be stored. The buffer must be large enough to hold the resulting string, including the null terminator. The caller retains ownership and must ensure it is not null.
    - `len`: The size of the buffer pointed to by str. It must be large enough to accommodate the formatted string and the null terminator. If the formatted string exceeds this length, it will be truncated.
    - `fmt`: A format string that specifies how to format the additional arguments. It must not be null and should follow the same rules as the format string in printf.
    - `...`: Additional arguments that are formatted according to the format string. The number and types of these arguments must match the format specifiers in fmt.
- **Output**: Returns the number of characters that would have been written if the buffer had been sufficiently large, not counting the null terminator. If the return value is greater than or equal to len, the output was truncated.
- **See also**: [`xsnprintf`](<xmalloc.c.md#xsnprintf>)  (Implementation)


---
### xvsnprintf<!-- {{#callable_declaration:xvsnprintf}} -->
[üîó View Source](<../../xmalloc.h#L43>)

Formats a string into a buffer using a variable argument list.
- **Description**: This function formats a string according to the specified format string and variable argument list, writing the result into the provided buffer. It is used when you need to format a string with arguments that are passed as a `va_list`. The function ensures that the formatted string does not exceed the specified buffer length, and it will terminate the program if the buffer length exceeds `INT_MAX` or if the formatted string would overflow the buffer. This function is useful in scenarios where you want to safely format strings without risking buffer overflows.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be stored. The buffer must be large enough to hold the resulting string, including the null terminator.
    - `len`: The maximum number of bytes to write to the buffer, including the null terminator. Must not exceed `INT_MAX`.
    - `fmt`: A format string that specifies how to format the arguments. Must not be null.
    - `ap`: A `va_list` containing the arguments to format according to the format string.
- **Output**: Returns the number of characters that would have been written if the buffer had been large enough, not counting the null terminator. If the return value is negative or greater than or equal to `len`, the function will terminate the program.
- **See also**: [`xvsnprintf`](<xmalloc.c.md#xvsnprintf>)  (Implementation)



---
Made with ‚ù§Ô∏è by [Driver](https://www.driver.ai/)