<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

The `xmalloc.h` file in the `spam-detection` codebase provides custom memory allocation functions that ensure error checking and never return failure, calling a fatal error handler instead.

# Purpose
This C header file, `xmalloc.h`, provides declarations for a set of memory management and string manipulation functions that enhance standard C library functions by incorporating error-checking mechanisms. The functions, such as [`xmalloc`](#xmalloc), [`xcalloc`](#xcalloc), [`xrealloc`](#xrealloc), and [`xstrdup`](#xstrdup), are designed to ensure that memory allocation operations do not fail silently; instead, they invoke a fatal error handler if an allocation error occurs. Additionally, the file includes safer versions of formatted output functions like [`xasprintf`](#xasprintf) and [`xsnprintf`](#xsnprintf), which include format string checking and non-null attribute specifications to prevent common errors. This header is part of a larger software project, likely related to secure communications, as indicated by the author's note on usage and naming conventions for derived works.
# Function Declarations (Public API)

---
### xmalloc<!-- {{#callable_declaration:xmalloc}} -->
Allocate memory and ensure allocation success.
- **Description**: This function allocates a block of memory of the specified size and guarantees that the allocation is successful. It should be used when you need to allocate memory and want to ensure that the program will not continue with a null pointer in case of allocation failure. If the requested size is zero or if the memory allocation fails, the function will terminate the program with an error message. This function is suitable for use in applications where memory allocation failures are considered fatal and should not be handled by the caller.
- **Inputs**:
    - `size`: The number of bytes to allocate. Must be greater than zero. If zero is passed, the function will terminate the program with an error message.
- **Output**: A pointer to the allocated memory block. The function never returns a null pointer; it will terminate the program if allocation fails.
- **See also**: [`xmalloc`](xmalloc.c.md#xmalloc)  (Implementation)


---
### xcalloc<!-- {{#callable_declaration:xcalloc}} -->
Allocates and zeroes memory for an array.
- **Description**: This function allocates memory for an array of `nmemb` elements, each of `size` bytes, and initializes all bytes in the allocated storage to zero. It is designed to be used when you need a guaranteed allocation without having to handle allocation failures, as it will terminate the program if the allocation fails or if either `nmemb` or `size` is zero. This function is useful in scenarios where the program cannot continue without the requested memory, ensuring that the caller does not need to check for null pointers after allocation.
- **Inputs**:
    - `nmemb`: The number of elements to allocate. Must be greater than zero. If zero, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero. If zero, the function will terminate the program.
- **Output**: A pointer to the allocated memory, which is initialized to zero. The program will terminate if the allocation fails.
- **See also**: [`xcalloc`](xmalloc.c.md#xcalloc)  (Implementation)


---
### xrealloc<!-- {{#callable_declaration:xrealloc}} -->
Reallocate memory to a new size, ensuring allocation success.
- **Description**: This function reallocates a given memory block to a new size, ensuring that the operation never fails by terminating the program if an error occurs. It is used when you need to resize an existing memory allocation, typically to accommodate more data. The function should be called with a valid pointer to a previously allocated memory block or NULL if allocating a new block. It is important to note that this function will not return a null pointer; instead, it will handle any allocation failure internally, ensuring that the caller does not need to check for null returns.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. It can be NULL if a new memory block is to be allocated. The caller retains ownership of the memory.
    - `size`: The new size for the memory block in bytes. It must be a non-zero value, and the function will handle any allocation errors internally.
- **Output**: A pointer to the reallocated memory block, which is guaranteed to be non-null.
- **See also**: [`xrealloc`](xmalloc.c.md#xrealloc)  (Implementation)


---
### xreallocarray<!-- {{#callable_declaration:xreallocarray}} -->
Reallocate memory for an array, ensuring allocation success.
- **Description**: This function reallocates memory for an array with a specified number of elements and element size, ensuring that the allocation is successful. It should be used when you need to resize an existing memory block pointed to by `ptr` to accommodate `nmemb` elements of `size` bytes each. The function will terminate the program if the allocation fails or if either `nmemb` or `size` is zero, ensuring that the caller never receives a null pointer. This function is useful in scenarios where memory allocation failures are considered fatal and should be avoided.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. It can be null, in which case the function behaves like `xmalloc` for the new size.
    - `nmemb`: The number of elements to allocate. Must be greater than zero; otherwise, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero; otherwise, the function will terminate the program.
- **Output**: A pointer to the newly allocated memory block, which is never null.
- **See also**: [`xreallocarray`](xmalloc.c.md#xreallocarray)  (Implementation)


---
### xrecallocarray<!-- {{#callable_declaration:xrecallocarray}} -->
Reallocate and zero-initialize an array, ensuring allocation success.
- **Description**: This function reallocates an array to a new size and ensures that any newly allocated memory is zero-initialized. It is designed to be used when you need to change the size of an existing memory block while ensuring that the operation never fails silently. If the reallocation fails or if the new size is zero, the function will terminate the program. This function is useful in scenarios where memory allocation failures must be handled by terminating the program to prevent undefined behavior.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. This can be NULL, in which case the function behaves like a call to xcalloc.
    - `oldnmemb`: The number of elements in the current memory block. Must be greater than zero if ptr is not NULL.
    - `nmemb`: The number of elements in the new memory block. Must be greater than zero; otherwise, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero; otherwise, the function will terminate the program.
- **Output**: Returns a pointer to the newly allocated and zero-initialized memory block. The program will terminate if allocation fails.
- **See also**: [`xrecallocarray`](xmalloc.c.md#xrecallocarray)  (Implementation)


---
### xstrdup<!-- {{#callable_declaration:xstrdup}} -->
Duplicates a string with error checking.
- **Description**: This function creates a duplicate of the given string, ensuring that memory allocation is successful. It should be used when a copy of a string is needed and the program cannot continue if memory allocation fails. The function will terminate the program with an error message if it encounters an allocation failure, making it suitable for use in applications where such failures are considered fatal.
- **Inputs**:
    - `str`: A pointer to a null-terminated string to be duplicated. Must not be null, as passing a null pointer will result in undefined behavior.
- **Output**: Returns a pointer to the newly allocated string, which is a duplicate of the input string. The caller is responsible for freeing the allocated memory.
- **See also**: [`xstrdup`](xmalloc.c.md#xstrdup)  (Implementation)


---
### xstrndup<!-- {{#callable_declaration:xstrndup}} -->
Duplicates a string up to a specified maximum length, ensuring successful allocation.
- **Description**: This function creates a duplicate of the input string, copying at most 'maxlen' characters, and ensures that memory allocation is successful. It is useful when you need a copy of a string with a limited length, and you want to ensure that the program terminates with an error message if memory allocation fails. This function should be used when you want to avoid handling memory allocation failures manually, as it will terminate the program if allocation is unsuccessful.
- **Inputs**:
    - `str`: The input string to be duplicated. Must not be null, as the function does not handle null pointers.
    - `maxlen`: The maximum number of characters to duplicate from the input string. Must be a non-negative value.
- **Output**: Returns a pointer to the newly allocated string containing up to 'maxlen' characters from the input string. The program will terminate if memory allocation fails.
- **See also**: [`xstrndup`](xmalloc.c.md#xstrndup)  (Implementation)


---
### xasprintf<!-- {{#callable_declaration:xasprintf}} -->
Formats a string and allocates memory for it.
- **Description**: This function formats a string according to the specified format and arguments, allocating memory to store the resulting string. It is useful when you need a formatted string but do not know the required buffer size in advance. The function must be called with a valid format string and a pointer to a char pointer, which will be set to point to the newly allocated string. The caller is responsible for freeing the allocated memory. The function will not return on memory allocation failure, as it is designed to handle such errors internally.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string as in printf. Must not be null. Specifies how the subsequent arguments are converted for output.
    - `...`: Additional arguments to be formatted according to the format string. The number and types of these arguments must match the format specifiers in the format string.
- **Output**: Returns the number of characters printed (excluding the null byte used to end output to strings).
- **See also**: [`xasprintf`](xmalloc.c.md#xasprintf)  (Implementation)


---
### xvasprintf<!-- {{#callable_declaration:xvasprintf}} -->
Formats a string and allocates memory for it, ensuring successful allocation.
- **Description**: This function formats a string according to the specified format and argument list, allocating memory for the resulting string. It is similar to `vasprintf`, but guarantees that memory allocation will not fail by terminating the program if an error occurs. This function should be used when you want to ensure that the formatted string is always successfully allocated, and you are prepared to handle program termination in case of allocation failure. It is important to note that the caller is responsible for freeing the allocated memory.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string that specifies how to format the output. Must not be null.
    - `ap`: A va_list of arguments to be formatted according to the format string. It should be initialized before calling this function.
- **Output**: Returns the number of characters in the formatted string, excluding the null terminator. If memory allocation fails, the function does not return, as it terminates the program.
- **See also**: [`xvasprintf`](xmalloc.c.md#xvasprintf)  (Implementation)


---
### xsnprintf<!-- {{#callable_declaration:xsnprintf}} -->
Formats a string and stores it in a buffer with size constraints.
- **Description**: This function is used to format a string according to a specified format and store the result in a provided buffer. It is similar to snprintf but includes additional safety checks. The function ensures that the formatted string does not exceed the specified buffer length, preventing buffer overflows. It must be called with a valid format string and a buffer that is large enough to hold the formatted output. The function is designed to handle variable argument lists, making it flexible for various formatting needs.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be stored. The buffer must be large enough to hold the resulting string, including the null terminator. The caller retains ownership and must ensure it is not null.
    - `len`: The size of the buffer pointed to by str. It defines the maximum number of characters to be written, including the null terminator.
    - `fmt`: A format string that specifies how to format the subsequent arguments. It must not be null and should follow printf-style formatting.
- **Output**: Returns the number of characters that would have been written if the buffer had been sufficiently large, not counting the terminating null character. If the return value is greater than or equal to len, the output was truncated.
- **See also**: [`xsnprintf`](xmalloc.c.md#xsnprintf)  (Implementation)


---
### xvsnprintf<!-- {{#callable_declaration:xvsnprintf}} -->
Formats a string into a buffer using a variable argument list.
- **Description**: This function formats a string according to the specified format string and variable argument list, writing the result into the provided buffer. It is used when you need to format a string with arguments that are passed as a `va_list`. The function ensures that the formatted string does not exceed the specified buffer length, and it will terminate the program if the buffer length exceeds `INT_MAX` or if the formatted string would overflow the buffer. This function should be used when you want to safely format strings without handling errors manually, as it will handle any potential overflow by terminating the program.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be written. The buffer must be large enough to hold the resulting string, including the null terminator.
    - `len`: The maximum number of bytes to write to the buffer, including the null terminator. Must not exceed `INT_MAX`.
    - `fmt`: A format string that specifies how to format the arguments. Must not be null.
    - `ap`: A `va_list` containing the arguments to format according to the format string.
- **Output**: Returns the number of characters that would have been written if the buffer had been large enough, not counting the null terminator. If the return value is negative or greater than or equal to `len`, the function will terminate the program.
- **See also**: [`xvsnprintf`](xmalloc.c.md#xvsnprintf)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)