<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

# Purpose
This C header file, `xmalloc.h`, provides declarations for a set of memory management and string manipulation functions that enhance standard C library functions by incorporating error checking and handling. The functions, such as [`xmalloc`](#xmalloc), [`xcalloc`](#xcalloc), [`xrealloc`](#xrealloc), and their variants, are designed to never return a failure; instead, they invoke a fatal error handler if an error occurs, ensuring robust memory allocation. Additionally, the file includes safer string duplication and formatted output functions like [`xstrdup`](#xstrdup), [`xasprintf`](#xasprintf), and [`xsnprintf`](#xsnprintf), which include attributes for format checking and non-null constraints to prevent common programming errors. This header is part of a larger software project, likely related to secure shell (SSH) development, as indicated by the author's note on usage and compatibility with protocol descriptions.
# Function Declarations (Public API)

---
### xmalloc<!-- {{#callable_declaration:xmalloc}} -->
Allocate memory and ensure allocation success.
- **Description**: This function allocates a block of memory of the specified size and ensures that the allocation is successful. It is intended for use when a guaranteed allocation is required, as it will terminate the program if the allocation fails or if a zero size is requested. This function should be used in scenarios where the program cannot continue without the requested memory, and it is acceptable for the program to exit on failure.
- **Inputs**:
    - `size`: The number of bytes to allocate. Must be greater than zero. If zero is passed, the function will terminate the program.
- **Output**: A pointer to the allocated memory block. The program will terminate if allocation fails.
- **See also**: [`xmalloc`](xmalloc.c.md#xmalloc)  (Implementation)


---
### xcalloc<!-- {{#callable_declaration:xcalloc}} -->
Allocates and zeroes memory for an array.
- **Description**: This function allocates memory for an array of `nmemb` elements, each of `size` bytes, and initializes all bytes in the allocated storage to zero. It is designed to never return a null pointer; if the allocation fails or if either `nmemb` or `size` is zero, the function will terminate the program. This function should be used when you need guaranteed allocation and initialization of memory, and you are prepared to handle program termination in case of allocation failure.
- **Inputs**:
    - `nmemb`: The number of elements to allocate. Must be greater than zero. If zero, the function will terminate the program.
    - `size`: The size in bytes of each element to allocate. Must be greater than zero. If zero, the function will terminate the program.
- **Output**: A pointer to the allocated memory, which is initialized to zero. The program will terminate if allocation fails.
- **See also**: [`xcalloc`](xmalloc.c.md#xcalloc)  (Implementation)


---
### xrealloc<!-- {{#callable_declaration:xrealloc}} -->
Reallocate memory with error checking.
- **Description**: This function reallocates a block of memory to a new size, ensuring that the operation never fails silently. It is useful when you need to resize an existing memory allocation and want to ensure that any errors in memory allocation are handled by terminating the program. This function should be used when you want to avoid manual error checking after reallocating memory, as it will automatically handle any allocation failures by calling a fatal error handler.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. This pointer can be NULL, in which case the function behaves like xmalloc and allocates a new block of memory. The caller retains ownership of the memory.
    - `size`: The new size for the memory block in bytes. Must be a positive value. If the size is zero, the behavior is implementation-defined, but typically the memory is freed.
- **Output**: A pointer to the newly allocated memory block, which is guaranteed to be non-NULL. The contents of the memory block are unchanged up to the lesser of the new and old sizes.
- **See also**: [`xrealloc`](xmalloc.c.md#xrealloc)  (Implementation)


---
### xreallocarray<!-- {{#callable_declaration:xreallocarray}} -->
Reallocate memory for an array, ensuring allocation success.
- **Description**: This function reallocates memory for an array with a specified number of elements and element size, ensuring that the allocation is successful. It should be used when you need to resize an existing memory block pointed to by `ptr` to accommodate `nmemb` elements of `size` bytes each. The function will terminate the program if the allocation fails or if either `nmemb` or `size` is zero, ensuring that the caller does not need to handle allocation failures. This function is suitable for use in applications where memory allocation failures are considered fatal and should not be handled gracefully.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. It can be NULL, in which case the function behaves like `xmalloc` for the new size.
    - `nmemb`: The number of elements to allocate. Must be greater than zero; otherwise, the function will terminate the program.
    - `size`: The size of each element in bytes. Must be greater than zero; otherwise, the function will terminate the program.
- **Output**: A pointer to the newly allocated memory block, which is never NULL.
- **See also**: [`xreallocarray`](xmalloc.c.md#xreallocarray)  (Implementation)


---
### xrecallocarray<!-- {{#callable_declaration:xrecallocarray}} -->
Reallocate and zero-initialize an array with error checking.
- **Description**: This function reallocates an array to a new size, ensuring that any newly allocated memory is zero-initialized. It is designed to be used when you need to change the size of an existing memory block while maintaining the contents of the original block and zeroing any additional memory. The function will terminate the program if the allocation fails or if either the number of elements or the size of each element is zero, ensuring that it never returns a null pointer. This function is suitable for use in environments where memory allocation failures are considered fatal errors.
- **Inputs**:
    - `ptr`: A pointer to the memory block to be reallocated. This pointer must have been returned by a previous call to a memory allocation function or be null.
    - `oldnmemb`: The number of elements in the current memory block. This value must accurately reflect the current allocation size.
    - `nmemb`: The desired number of elements in the new memory block. Must be greater than zero.
    - `size`: The size of each element in bytes. Must be greater than zero.
- **Output**: A pointer to the newly allocated memory block, which is zero-initialized beyond the original size.
- **See also**: [`xrecallocarray`](xmalloc.c.md#xrecallocarray)  (Implementation)


---
### xstrdup<!-- {{#callable_declaration:xstrdup}} -->
Duplicates a string with error handling.
- **Description**: This function creates a duplicate of the given string, ensuring that memory allocation is successful. It is used when a copy of a string is needed and the program cannot continue if memory allocation fails. The function will terminate the program with an error message if it cannot allocate the necessary memory, making it suitable for use in applications where such failures are considered fatal.
- **Inputs**:
    - `str`: A pointer to a null-terminated string that is to be duplicated. Must not be null, as passing a null pointer will result in undefined behavior. The caller retains ownership of the original string.
- **Output**: Returns a pointer to the newly allocated string that is a duplicate of the input string. The caller is responsible for freeing this memory when it is no longer needed.
- **See also**: [`xstrdup`](xmalloc.c.md#xstrdup)  (Implementation)


---
### xstrndup<!-- {{#callable_declaration:xstrndup}} -->
Duplicates a string up to a specified maximum length, ensuring successful allocation.
- **Description**: This function duplicates a given string up to a specified maximum length, ensuring that memory allocation is successful. It is useful when you need a copy of a string but want to limit the number of characters copied to prevent excessive memory usage. The function will terminate the program if memory allocation fails, making it suitable for use in applications where such failures are considered fatal. It should be used when the caller can guarantee that the input string is valid and when the program's logic can tolerate termination on allocation failure.
- **Inputs**:
    - `str`: A pointer to the null-terminated string to be duplicated. Must not be null, and the caller retains ownership of the original string.
    - `maxlen`: The maximum number of characters to duplicate from the input string, including the null terminator. Must be a non-negative value.
- **Output**: A pointer to the newly allocated string containing up to 'maxlen' characters from the input string, including the null terminator.
- **See also**: [`xstrndup`](xmalloc.c.md#xstrndup)  (Implementation)


---
### xasprintf<!-- {{#callable_declaration:xasprintf}} -->
Formats a string and allocates memory for it.
- **Description**: This function formats a string according to the specified format and arguments, allocating memory to store the resulting string. It is useful when you need a formatted string but do not know the required buffer size in advance. The function ensures that memory allocation is successful, and it will not return on failure, instead calling a fatal error handler. It must be called with a valid format string and a pointer to a char pointer that will receive the address of the allocated string. The caller is responsible for freeing the allocated memory when it is no longer needed.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated formatted string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string as in printf. Must not be null. Specifies how the subsequent arguments are converted for output.
    - `...`: A variable number of arguments that are formatted according to the format string. The number and types of these arguments must match the format specifiers in the format string.
- **Output**: Returns the number of characters in the formatted string, excluding the null terminator.
- **See also**: [`xasprintf`](xmalloc.c.md#xasprintf)  (Implementation)


---
### xvasprintf<!-- {{#callable_declaration:xvasprintf}} -->
Formats a string and allocates memory for it, ensuring no failure occurs.
- **Description**: This function formats a string according to the specified format and arguments, similar to `vasprintf`, but ensures that memory allocation failures are handled by terminating the program. It is useful when you want to safely format a string without manually checking for allocation errors. The function must be called with a valid format string, and the caller is responsible for freeing the allocated memory pointed to by `ret`.
- **Inputs**:
    - `ret`: A pointer to a char pointer where the address of the allocated string will be stored. Must not be null. The caller is responsible for freeing the allocated memory.
    - `fmt`: A format string that specifies how to format the output. Must not be null.
    - `ap`: A `va_list` of arguments to be formatted according to the format string. Must be properly initialized before calling this function.
- **Output**: Returns the number of characters printed (excluding the null byte) or terminates the program if memory allocation fails.
- **See also**: [`xvasprintf`](xmalloc.c.md#xvasprintf)  (Implementation)


---
### xsnprintf<!-- {{#callable_declaration:xsnprintf}} -->
Formats a string and stores it in a buffer with size checking.
- **Description**: This function formats a string according to the specified format string and stores the result in the provided buffer. It is used when you need to safely format a string with variable arguments, ensuring that the buffer is not overflowed. The function must be called with a valid format string and a buffer that is large enough to hold the formatted output, including the null terminator. It is important to ensure that the format string is not null, as this will lead to undefined behavior. The function returns the number of characters that would have been written if the buffer had been sufficiently large, not counting the terminating null character.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be stored. The buffer must be large enough to hold the resulting string and a null terminator. The caller retains ownership and must ensure the buffer is valid.
    - `len`: The size of the buffer pointed to by 'str'. It must be large enough to store the formatted string and a null terminator. If the buffer is too small, the output will be truncated.
    - `fmt`: A format string that specifies how to format the variable arguments. It must not be null, and it follows the same specifications as the format string in printf.
    - `...`: A variable number of arguments that are formatted according to the format string 'fmt'. The types and number of these arguments must match the format specifiers in 'fmt'.
- **Output**: Returns the number of characters that would have been written if the buffer had been sufficiently large, not including the terminating null character.
- **See also**: [`xsnprintf`](xmalloc.c.md#xsnprintf)  (Implementation)


---
### xvsnprintf<!-- {{#callable_declaration:xvsnprintf}} -->
Formats a string into a buffer using a variable argument list.
- **Description**: This function formats a string according to a specified format and stores the result in a provided buffer. It is used when you have a variable argument list that needs to be formatted into a string. The function ensures that the formatted string does not exceed the specified buffer length, and it will terminate the program if an overflow is detected or if the length exceeds INT_MAX. This function should be used when you need a safe way to format strings with variable arguments, ensuring that buffer overflows are avoided.
- **Inputs**:
    - `str`: A pointer to the buffer where the formatted string will be stored. The buffer must be large enough to hold the resulting string, including the null terminator. The caller retains ownership and must ensure it is not null.
    - `len`: The maximum number of bytes to write to the buffer, including the null terminator. Must not exceed INT_MAX. If len is greater than INT_MAX, the function will terminate the program.
    - `fmt`: A format string that specifies how to format the variable arguments. Must not be null. The format string follows the same specifications as printf.
    - `ap`: A va_list representing the variable arguments to be formatted according to the format string. The caller is responsible for initializing and managing the va_list.
- **Output**: Returns the number of characters that would have been written if len had been sufficiently large, not counting the terminating null character. If the return value is negative or greater than or equal to len, the function will terminate the program.
- **See also**: [`xvsnprintf`](xmalloc.c.md#xvsnprintf)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)